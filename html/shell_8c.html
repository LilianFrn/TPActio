<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: TP_Actionneur/Core/Src/shell.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_acdc5646ab76ff805fc9533ee37267c8.html">TP_Actionneur</a></li><li class="navelem"><a class="el" href="dir_7a63e2a7a3089a1afb91cfe87f0d9a31.html">Core</a></li><li class="navelem"><a class="el" href="dir_323ff206305d9c2f7fcf8b992eb994d1.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">shell.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Shell program body.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;string.h&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;shell.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for shell.c:</div>
<div class="dyncontent">
<div class="center"><img src="shell_8c__incl.png" border="0" usemap="#aTP__Actionneur_2Core_2Src_2shell_8c" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad1f18f739da7703628c3663209463a0d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shell_8c.html#ad1f18f739da7703628c3663209463a0d">shell_start</a> (void)</td></tr>
<tr class="memdesc:ad1f18f739da7703628c3663209463a0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set la mémoire des variables utilisées par le Shell, print le mssage de bienvenue et lance la première interruption UART.  <a href="shell_8c.html#ad1f18f739da7703628c3663209463a0d">More...</a><br /></td></tr>
<tr class="separator:ad1f18f739da7703628c3663209463a0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a41609fa1e3d6dbbecd0b5cd28fae0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shell_8c.html#a9a41609fa1e3d6dbbecd0b5cd28fae0f">shell_process</a> (void)</td></tr>
<tr class="memdesc:a9a41609fa1e3d6dbbecd0b5cd28fae0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Traite le caractère reçu à chaque entrée, met le flag pour lancer la commande à 1 si le CR est détecté  <a href="shell_8c.html#a9a41609fa1e3d6dbbecd0b5cd28fae0f">More...</a><br /></td></tr>
<tr class="separator:a9a41609fa1e3d6dbbecd0b5cd28fae0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3529f29606412127c579b098455bfe92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shell_8c.html#a3529f29606412127c579b098455bfe92">shell_execute</a> (void)</td></tr>
<tr class="memdesc:a3529f29606412127c579b098455bfe92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fonction permettant de reconnaître une commande et l'éxécuter<br  />
 -help : Liste les fonctions disponibles<br  />
 -pinout : Donne le pinout de la carte<br  />
 -start : Génère des PWM avec rapport cyclique a 50%<br  />
 -speed : Argument : nombre compris entre 0 et 1023 (512 etant le rapport cyclique de 50%)<br  />
 -stop : Arrête les PWM<br  />
 -current : Récupère le courant pour l'asservissement (non testée)  <a href="shell_8c.html#a3529f29606412127c579b098455bfe92">More...</a><br /></td></tr>
<tr class="separator:a3529f29606412127c579b098455bfe92"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a25fc663547539bc49fecc0011bd76ab5"><td class="memItemLeft" align="right" valign="top"><a id="a25fc663547539bc49fecc0011bd76ab5"></a>
<a class="el" href="structTIM__HandleTypeDef.html">TIM_HandleTypeDef</a>&#160;</td><td class="memItemRight" valign="bottom"><b>htim1</b></td></tr>
<tr class="separator:a25fc663547539bc49fecc0011bd76ab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9479c261d65eecedd3d9582f7f0f89c"><td class="memItemLeft" align="right" valign="top"><a id="aa9479c261d65eecedd3d9582f7f0f89c"></a>
<a class="el" href="group__UART__Exported__Types.html#ga5de4a49eb132735325e706f406c69d6e">UART_HandleTypeDef</a>&#160;</td><td class="memItemRight" valign="bottom"><b>huart2</b></td></tr>
<tr class="separator:aa9479c261d65eecedd3d9582f7f0f89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd9221f1aa19aebfe0b744947f2daf49"><td class="memItemLeft" align="right" valign="top"><a id="acd9221f1aa19aebfe0b744947f2daf49"></a>
<a class="el" href="structADC__HandleTypeDef.html">ADC_HandleTypeDef</a>&#160;</td><td class="memItemRight" valign="bottom"><b>hadc2</b></td></tr>
<tr class="separator:acd9221f1aa19aebfe0b744947f2daf49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d8a518124b90c249458a5b30ab36c52"><td class="memItemLeft" align="right" valign="top"><a id="a9d8a518124b90c249458a5b30ab36c52"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><b>uartRxReceived</b></td></tr>
<tr class="separator:a9d8a518124b90c249458a5b30ab36c52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2542ac6d4440b9e1c4a6435c55c79df3"><td class="memItemLeft" align="right" valign="top"><a id="a2542ac6d4440b9e1c4a6435c55c79df3"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>uartRxBuffer</b> [UART_RX_BUFFER_SIZE]</td></tr>
<tr class="separator:a2542ac6d4440b9e1c4a6435c55c79df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f98e2db2fa0d8f0cfd87b887576207f"><td class="memItemLeft" align="right" valign="top"><a id="a3f98e2db2fa0d8f0cfd87b887576207f"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>uartTxBuffer</b> [UART_TX_BUFFER_SIZE]</td></tr>
<tr class="separator:a3f98e2db2fa0d8f0cfd87b887576207f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb32291986b24711ba628581bd8c3246"><td class="memItemLeft" align="right" valign="top"><a id="acb32291986b24711ba628581bd8c3246"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>cmd_ready</b></td></tr>
<tr class="separator:acb32291986b24711ba628581bd8c3246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b512d0a6dcc3c7d7e6dd9a7714852c4"><td class="memItemLeft" align="right" valign="top"><a id="a4b512d0a6dcc3c7d7e6dd9a7714852c4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>vitesse</b> = 0</td></tr>
<tr class="separator:a4b512d0a6dcc3c7d7e6dd9a7714852c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae59df4a59773ed74bbc9708d0f741934"><td class="memItemLeft" align="right" valign="top"><a id="ae59df4a59773ed74bbc9708d0f741934"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><b>courant</b> = 0</td></tr>
<tr class="separator:ae59df4a59773ed74bbc9708d0f741934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f3de16b386b5b3f15d9b5eb4189280"><td class="memItemLeft" align="right" valign="top"><a id="a68f3de16b386b5b3f15d9b5eb4189280"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>vitesse_buffer</b> [4]</td></tr>
<tr class="separator:a68f3de16b386b5b3f15d9b5eb4189280"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b893859891afe33d4bba72ba06fd381"><td class="memItemLeft" align="right" valign="top"><a id="a8b893859891afe33d4bba72ba06fd381"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>prompt</b> [] =&quot;user@Nucleo-STM32G474&gt;&gt;&quot;</td></tr>
<tr class="separator:a8b893859891afe33d4bba72ba06fd381"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a835573497a60b314a9bf5a6fcac9602a"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>started</b> []</td></tr>
<tr class="separator:a835573497a60b314a9bf5a6fcac9602a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98a2c452a5e7053154e9f49a4cad4e98"><td class="memItemLeft" align="right" valign="top"><a id="a98a2c452a5e7053154e9f49a4cad4e98"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>newline</b> [] =&quot;\r\n&quot;</td></tr>
<tr class="separator:a98a2c452a5e7053154e9f49a4cad4e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25205e7c6d817620c1d9f7351a817a04"><td class="memItemLeft" align="right" valign="top"><a id="a25205e7c6d817620c1d9f7351a817a04"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>cmdNotFound</b> [] =&quot;Command not found\r\n&quot;</td></tr>
<tr class="separator:a25205e7c6d817620c1d9f7351a817a04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14258017916e3981b4255388d7a2030"><td class="memItemLeft" align="right" valign="top"><a id="ab14258017916e3981b4255388d7a2030"></a>
uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><b>com</b> [COM_NB] ={&quot;help&quot;, &quot;pinout&quot;, &quot;start&quot;, &quot;stop&quot;, &quot;speed&quot;, &quot;current&quot;}</td></tr>
<tr class="separator:ab14258017916e3981b4255388d7a2030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a541b31b5e83102b03fd6c355c4ae3dfa"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><b>pins</b> [PIN_NB]</td></tr>
<tr class="separator:a541b31b5e83102b03fd6c355c4ae3dfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc4a218b16a0bc450c28357689c6198"><td class="memItemLeft" align="right" valign="top"><a id="a6cc4a218b16a0bc450c28357689c6198"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>vitesseMaxTx</b> [] =&quot;Vitesse trop importante&quot;</td></tr>
<tr class="separator:a6cc4a218b16a0bc450c28357689c6198"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Shell program body. </p>
<dl class="section author"><dt>Author</dt><dd>Solène Altaber, Lilian Fournier, Corentin Fraysse</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd></dd></dl>
<p>Copyright (c) 2022 STMicroelectronics. All rights reserved.</p>
<p>This software is licensed under terms that can be found in the LICENSE file in the root directory of this software component. If no LICENSE file comes with this software, it is provided AS-IS. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3529f29606412127c579b098455bfe92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3529f29606412127c579b098455bfe92">&#9670;&nbsp;</a></span>shell_execute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shell_execute </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fonction permettant de reconnaître une commande et l'éxécuter<br  />
 -help : Liste les fonctions disponibles<br  />
 -pinout : Donne le pinout de la carte<br  />
 -start : Génère des PWM avec rapport cyclique a 50%<br  />
 -speed : Argument : nombre compris entre 0 et 1023 (512 etant le rapport cyclique de 50%)<br  />
 -stop : Arrête les PWM<br  />
 -current : Récupère le courant pour l'asservissement (non testée) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>nothing </dd></dl>

</div>
</div>
<a id="a9a41609fa1e3d6dbbecd0b5cd28fae0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a41609fa1e3d6dbbecd0b5cd28fae0f">&#9670;&nbsp;</a></span>shell_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shell_process </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Traite le caractère reçu à chaque entrée, met le flag pour lancer la commande à 1 si le CR est détecté </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>nothing </dd></dl>

</div>
</div>
<a id="ad1f18f739da7703628c3663209463a0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1f18f739da7703628c3663209463a0d">&#9670;&nbsp;</a></span>shell_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shell_start </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set la mémoire des variables utilisées par le Shell, print le mssage de bienvenue et lance la première interruption UART. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>nothing </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a541b31b5e83102b03fd6c355c4ae3dfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a541b31b5e83102b03fd6c355c4ae3dfa">&#9670;&nbsp;</a></span>pins</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* pins[PIN_NB]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">={<span class="stringliteral">&quot;PA0 : ADC2_IN1&quot;</span>, <span class="stringliteral">&quot;PA2 : USART2_TX&quot;</span>, <span class="stringliteral">&quot;PA3 : USART2_RX&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;PA5 : GREEN_LED&quot;</span>, <span class="stringliteral">&quot;PA8 : TIM1_CH1&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;PA9 : TIM1_CH2&quot;</span>, <span class="stringliteral">&quot;PA11 : TIM1_CH1N&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;PA12 : TIM1_CH2N&quot;</span>, <span class="stringliteral">&quot;PA13 : T_SWDIO&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;PA14 : T_SWCLK&quot;</span>, <span class="stringliteral">&quot;PC1 : ADC2_IN7&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;PC3 : ISO_RESET&quot;</span>, <span class="stringliteral">&quot;PC13 : BLUE_BUTTON&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;PC14 : RCC_OSC32_IN&quot;</span>, <span class="stringliteral">&quot;PC15 : RCC_OSC32_OUT&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;PF0 : RCC_OSC_IN&quot;</span>, <span class="stringliteral">&quot;PF1 : RCC_OSC_OUT&quot;</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a835573497a60b314a9bf5a6fcac9602a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a835573497a60b314a9bf5a6fcac9602a">&#9670;&nbsp;</a></span>started</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t started[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">        <span class="stringliteral">&quot;\r\n*-----------------------------*&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\r\n| Welcome on Nucleo-STM32G474RET |&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\r\n*-----------------------------*&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\r\n&quot;</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
